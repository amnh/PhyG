--read(fasta:"metazoa-aa-1.fas")
--read(fasta:"chel.fas")
read(prefasta:"chel-prealiged.fas")
--read(fasta:"chel.fas", tcm:"sg2t1.mat")
-- read(fasta:"chel.fas", tcm:"sg2t2.mat")

set(finalassignment:ia)

-- For network testing
--set (outgroup:"one")
--set(graphtype:softwired)
--Set(Compressresolutions:True)
--set(graphFactor:NoPenalty)
--set(rootcost:NoRootCost)

set(seed:1)
--build(replicates:20)
build(distance, dwag, rdwag, replicates:10)
--build(nj, wpgma, dwag, distance, rdwag, replicates:10, best:10)
--build(distance, rdwag, replicates:10, best:10)
-- report("new-401-distance.csv", pairdist, overwrite)
-- set(graphType:softwired)
--select(unique:5)
--fuse(spr)
--report("test-build.tre",overwrite, graphs, newick)
-- swap(spr, steepest)
--swap(spr, all:5)
--swap(spr, ia)
--swap(tbr, steepest)
--refine(netadd)
--select(unique)
--swap (tbr, annealing:4, steps:20)
--swap(tbr, steepest)
--select(unique)
--refine (ga, popsize:20, generations:4, severity:0, recombinations:50)
--select(unique)
--swap(tbr, all)
--search(seconds:90, instances:4)
--select(best)
-- support(gb:tbr, gbsample:10000)
swap(tbr, steepest)
select(best)
report("test0-data.csv", data, overwrite)
report("test0-wag.txt", overwrite, graphs, ascii)
report("test0-wag.dot", overwrite, graphs, dot)
report("test0-wag.tre", overwrite, graphs, newick)
report("test0-dist-mat.csv", pairdist, overwrite)
report("test0-diag.csv", diagnosis, overwrite)
report("test-search-data", search, overwrite)
report("test0-supp.dot", support,dotpdf, overwrite)
report("test-ia.fas", impliedalignment, overwrite)
report("test-tnt.txt", TNT, overwrite)